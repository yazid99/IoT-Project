@{
    ViewData["Title"] = "Services";
}
@using Microsoft.AspNetCore.Identity

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
<link rel="stylesheet" href="~/css/fullscreenModal.css" />
<script type='text/javascript' src='~/js/Module_Products/Library_InfiniteScroll.js'></script>
<div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="6000">
    <ol class="carousel-indicators">
        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
        <li data-target="#myCarousel" data-slide-to="1"></li>
        <li data-target="#myCarousel" data-slide-to="2"></li>
        <li data-target="#myCarousel" data-slide-to="3"></li>
    </ol>
    <div class="carousel-inner" role="listbox">
        <div class="item active">
            <img src="~/images/1.jpg" alt="ASP.NET" class="img-responsive" />
            <div class="carousel-caption" role="option">
                <p>
                    Learn how to build ASP.NET apps that can run anywhere.
                    <a class="btn btn-default" href="https://go.microsoft.com/fwlink/?LinkID=525028&clcid=0x409">
                        Learn More
                    </a>
                </p>
            </div>
        </div>
        <div class="item">
            <img src="~/images/2.jpg" alt="Visual Studio" class="img-responsive" />
            <div class="carousel-caption" role="option">
                <p>
                    There are powerful new features in Visual Studio for building modern web apps.
                    <a class="btn btn-default" href="https://go.microsoft.com/fwlink/?LinkID=525030&clcid=0x409">
                        Learn More
                    </a>
                </p>
            </div>
        </div>
        <div class="item">
            <img src="~/images/3.jpg" alt="Package Management" class="img-responsive" />
            <div class="carousel-caption" role="option">
                <p>
                    Bring in libraries from NuGet and npm, and automate tasks using Grunt or Gulp.
                    <a class="btn btn-default" href="https://go.microsoft.com/fwlink/?LinkID=525029&clcid=0x409">
                        Learn More
                    </a>
                </p>
            </div>
        </div>
        <div class="item">
            <img src="~/images/4.jpg" alt="Microsoft Azure" class="img-responsive" />
            <div class="carousel-caption" role="option">
                <p>
                    Learn how Microsoft's Azure cloud platform allows you to build, deploy, and scale web apps.
                    <a class="btn btn-default" href="https://go.microsoft.com/fwlink/?LinkID=525027&clcid=0x409">
                        Learn More
                    </a>
                </p>
            </div>
        </div>
    </div>
    <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
</div>
<div class="container body-content" ng-app="Module_Products">
     <div class="row"  ng-controller="Controller_Layanans">
        <!-- modal1 -->
        <div id="fsModal"
            class="modal fade"
            tabindex="-1"
            role="dialog"
            aria-labelledby="myModalLabel"
            aria-hidden="true"
            style="padding:0">
        <!-- dialog1 -->
        <div class="modal-dialog" style="position:relative">
            <!-- content -->
            <div class="modal-content">
            <!-- header -->
            <div class="videoContainer" style="position:absolute;top:-30%;z-index:0">
                <iframe id="video" src="https://www.youtube.com/embed/7T7HlfCv0fg?controls=0&showinfo=0&rel=0&autoplay=1&mute=1&loop=1&playlist=7T7HlfCv0fg" frameborder="0" allowfullscreen></iframe>
            </div>
            <img class="img-fluid img-thumbnail" style="position:absolute;z-index:10;left:20px;top:90px" width="200" height="200"  src="~/images/productAssets/{{thumbs[current].productsPictures[0].path}}" alt="">
            
            <script>
                    // If you want to keep full screen on window resize
                    $(window).resize(function(){
                        $('#video').css({ width: $(window).innerWidth() + 'px', height: $(window).innerHeight() + 'px' });
                    });

            </script>
            <div class="modal-header">
                <h1 id="myModalLabel"
                    class="modal-title success">
                    Layanan 
                </h1>
            </div>
            <!-- header -->
            <!-- body -->
            <div class="modal-body" style="margin-top:200px;padding-top:35px;background:white">                
                
                <h2>{{thumbs[current].name}}</h2>
                <h3>Rp {{thumbs[current].layanans.price}}</h3>
                <p>{{thumbs[current].descriptions}}</p>
                <div class="panel panel-default">
                   
                    <div class="panel-body">Memerlukan {{thumbs[current].requiredWorker}} orang pekerja</div>
                </div>
                
            </div>
            <!-- body -->
            <!-- footer -->
            <div class="modal-footer">
                <button class="btn btn-secondary"
                        data-dismiss="modal">
                Batal
                </button>
                @if (SignInManager.IsSignedIn(User))
                {
                    <button class="btn btn-success" id="order">
                        Order
                    </button>
                }
                else
                {
                     <button class="btn btn-success" onclick="alert('anda harus login')">
                        Login dan order
                    </button>
                }
            </div>
            <!-- footer -->
            </div>
            <!-- content -->
        </div>
        <!-- dialog1 -->
        </div>
        <!-- modal1 -->
        @if (SignInManager.IsSignedIn(User))
        {
        <!-- modal2 -->
        <div id="fsModal2"
            class="modal fade"
            tabindex="-1"
            role="dialog"
            aria-labelledby="myModalLabel2"
            aria-hidden="true"
            style="padding:0">
        <!-- dialog2 -->
        <div class="modal-dialog" style="position:relative">
            <div class="panel panel-default" style="position:absolute;top:100px;left:50px;z-index:10">
                    <div class="panel-body" id="lib_location_address">Klik cek alamat</div>
            </div>
            <!-- content -->
            <div class="modal-content">
            <!-- header -->
            <div class="modal-header">
                <h1 id="myModalLabel"
                    class="modal-title success">
                    Lokasi
                </h1>
            </div>
            <!-- header -->
            <!-- body -->
            <div class="modal-body">         
                    <div id="lib_location_myMap" style="position:relative;width:90%;height:40%;"></div>
                    <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?callback=GetMap' async defer></script>
                    <script type="text/javascript" src="~/js/Module_Products/Library_Location.js" async defer></script>
            </div>
            <!-- body -->
            <!-- footer -->
            <div class="modal-footer">
                <button class="btn btn-secondary"
                        data-dismiss="modal">
                        Batal
                </button>
                <button class="btn btn-default" id="lib_location_cek_alamat" onclick="reverseGeocode()" >
                        Cek Alamat
                    </button>
                    <button class="btn btn-success" id="lib_location_konfirmasi">
                        Konfirmasi
                    </button>
            </div>
            <!-- footer -->
            </div>
            <!-- content -->
        </div>
        <!-- dialog2 -->
        </div>
        <!-- modal2 -->

        <!-- modal3 -->
        <div id="fsModal3"
            class="modal fade"
            tabindex="-1"
            role="dialog"
            aria-labelledby="myModalLabel3"
            aria-hidden="true"
            style="padding:0">
        <!-- dialog3 -->
        <div class="modal-dialog" style="position:relative">
            <!-- content -->
            <div class="modal-content">
            <!-- header -->
            <div class="modal-header">
                <h1 id="myModalLabel"
                    class="modal-title success">
                    Silahkan menuggu...
                </h1>
            </div>
            <!-- header -->
            <!-- body -->
            <div class="modal-body modal-with-image" 
                style="background:url('images/hourglass.png');
                background-repeat: no-repeat;
                background-size: 200px;
                background-position: bottom right;">         
                <h1>Sedang mencarikan gardener untuk anda</h1>
                <p>Mohon untuk sabar.</p>
                <div class="panel panel-default">
                    <div class="panel-body">
                        Anda telah mengorder:
                        <ul>
                            <li>{{thumbs[current].name}}</li>
                        </ul>
                        <strong>Total: Rp {{thumbs[current].layanans.price}} </strong> <br>
                        <strong>Estimasi waktu: 4 menit</strong>
                    </div>
                </div>
            </div>
            <!-- body -->
            <!-- footer -->
            <div class="modal-footer">
                    <button class="btn btn-default" id="end_to_do_fix_me_so_I_can_order_for_real">
                        Sembunyikan dan notifikasi saya kembali
                    </button>
            </div>
            <!-- footer -->
            </div>
            <!-- content -->
        </div>
        <!-- dialog3 -->
        </div>
        <!-- modal3 -->
        }
        <div class="section-header">
            <h2>Top Service</h2> 
            <p>Layanan yang paling sering diorder!</p>
        </div>
        <!-- ng rpeat max 8 -->
         <div infinite-scroll="loadMore()" infinte-scroll-distance="2" class="row text-center text-lg-left">
            <div ng-repeat="t in thumbs" 
                 ng-if="t.id!=null" 
                 class="col-lg-3 col-md-4 col-xs-6 thumb-pad"
                 ng-click="selectThumb($index)"
                 data-toggle="modal"
                 data-target="#fsModal" >
                <a href="#" class="d-block mb-4 h-100">
                    <img class="img-fluid img-thumbnail" width="400"  src="~/images/productAssets/{{t.productsPictures[0].path}}" alt="">
                   
                </a>
                <div class="centered-imglabel">{{t.name}}</div>
            </div>
        </div>
    </div>
    <script>
        jQuery("#order").on( "click", function() 
        {
            jQuery('#fsModal').modal('hide');  
            jQuery('#fsModal2').modal('show');  
        });

        jQuery("#lib_location_konfirmasi").on( "click", function() 
        {
            jQuery('#fsModal2').modal('hide');  
            jQuery('#fsModal3').modal('show');  
        });
        jQuery("#end_to_do_fix_me_so_I_can_order_for_real").on("click", function()
        {
            jQuery('#fsModal3').modal('hide');  
        });
    </script>
    <script type='text/javascript' src='~/js/Module_Products/Controller_Layanans.js'></script>
</div>